!function(){function r(r){e.r([n[r]])}var e={r:function(r){if(e[r].inited)return e[r].value;if("function"!=typeof e[r].value)return e[r].inited=!0,e[r].value;var n={exports:{}},t=e[r].value(null,n.exports,n);if(e[r].inited=!0,e[r].value=t,void 0!==t)return t;for(var a in n.exports)if(n.exports.hasOwnProperty(a))return e[r].inited=!0,e[r].value=n.exports,n.exports}};e[0]={value:function(){function r(r){this.formula=r}function e(r,a,i,u,c){var s,l=null,p=null,f=[],h=a.operand||[],d=null;if(i.operand=[],-1===a.name.indexOf("text")){for(var v=0,m=h.length;m>v;v++)l=h[v],l!==o?l?"string"==typeof l?(h[v]="brackets"===a.name&&2>v?l:"function"===a.name&&0===v?l:n("text",l),i.operand.push(h[v])):(i.operand.push({}),h[v]=e(r.operand[v],l,i.operand[i.operand.length-1],u,c)):(h[v]=n("empty"),i.operand.push(h[v])):(f.push(v),c.hasOwnProperty("startOffset")||(c.startOffset=v),c.endOffset=v,a.attr&&a.attr.id&&(c.groupId=a.attr.id));for(2===f.length&&(c.endOffset-=1);v=f.length;)v=f[v-1],h.splice(v,1),f.length--,r.operand.splice(v,1)}if(d=t(a.name),!d)throw new Error("operator type error: not found "+a.operator);s=function(){},s.prototype=d.prototype,p=new s,d.apply(p,h),i.func=p;for(var g in a.callFn)a.callFn.hasOwnProperty(g)&&p[g]&&p[g].apply(p,a.callFn[g]);return a.attr&&(a.attr.id&&(u[a.attr.id]={objGroup:p,strGroup:r}),a.attr["data-root"]&&(u.root={objGroup:p,strGroup:r}),p.setAttr(a.attr)),p}function n(r,e){switch(r){case"empty":return new kf.EmptyExpression;case"text":return new kf.TextExpression(e)}}function t(r){return u[r]||kf[r.replace(/^[a-z]/i,function(r){return r.toUpperCase()}).replace(/-([a-z])/gi,function(r,e){return e.toUpperCase()})+"Expression"]}function a(r){var e={};if("[object Array]"==={}.toString.call(r)){e=[];for(var n=0,t=r.length;t>n;n++)e[n]=i(r[n])}else for(var a in r)r.hasOwnProperty(a)&&(e[a]=i(r[a]));return e}function i(r){return r?"object"!=typeof r?r:a(r):r}var u={},o="";return r.prototype.generateBy=function(r){var n=r.tree,t={},i={},u={};if("string"==typeof n)throw new Error("Unhandled error");return this.formula.appendExpression(e(n,a(n),t,u,i)),{select:i,parsedTree:n,tree:t,mapping:u}},r.prototype.regenerateBy=function(r){return this.formula.clearExpressions(),this.generateBy(r)},r}},e[1]={value:function(){return{toRPNExpression:e.r(2),generateTree:e.r(3)}}},e[2]={value:function(){function r(e){var a=[],i=null;for(e=n(e);i=e.shift();)"combination"===i.name&&1===i.operand.length&&"brackets"===i.operand[0].name&&(i=i.operand[0]),a.push(t.isArray(i)?r(i):i);return a}function n(r){for(var e=[],n=null;void 0!==(n=r.pop());)if(!n||"object"!=typeof n||n.sign!==!1&&"function"!==n.name)e.push(n);else{var t=n.handler(n,[],e.reverse());e.unshift(t),e.reverse()}return e.reverse()}var t=e.r(4);return r}},e[3]={value:function(){function r(e){for(var a=null,i=[],u=0,o=e.length;o>u;u++)t.isArray(e[u])&&(e[u]=r(e[u]));for(;a=e.shift();)i.push("object"==typeof a&&a.handler?a.handler(a,i,e):a);return n(i)}var n=e.r(13),t=e.r(4);return r}},e[4]={value:function(){var r=e.r(7),n=e.r(6),t=e.r(15),a={getLatexType:function(e){return e=e.replace(/^\\/,""),r[e]?"operator":n[e]?"function":"text"},isArray:function(r){return r&&"[object Array]"===Object.prototype.toString.call(r)},getDefine:function(e){return a.extend({},r[e.replace("\\","")])},getFuncDefine:function(r){return{name:"function",params:r.replace(/^\\/,""),handler:t}},getBracketsDefine:function(e,n){return a.extend({params:[e,n]},r.brackets)},extend:function(r,e){for(var n in e)e.hasOwnProperty(n)&&(r[n]=e[n]);return r}};return a}},e[5]={value:function(){var r=!0;return{".":r,"{":r,"}":r,"[":r,"]":r,"(":r,")":r,"|":r}}},e[6]={value:function(){return{sin:1,cos:1,arccos:1,cosh:1,det:1,inf:1,limsup:1,Pr:1,tan:1,arcsin:1,cot:1,dim:1,ker:1,ln:1,sec:1,tanh:1,arctan:1,coth:1,exp:1,lg:1,log:1,arg:1,csc:1,gcd:1,lim:1,max:1,sinh:1,deg:1,hom:1,liminf:1,min:1,sup:1}}},e[7]={value:function(){var r=e.r(22),n=e.r(11);return{"^":{name:"superscript",type:n.OP,handler:r},_:{name:"subscript",type:n.OP,handler:r},frac:{name:"fraction",type:n.FN,sign:!1,handler:e.r(14)},dfrac:{name:"fraction",type:n.FN,sign:!1,handler:e.r(14)},sqrt:{name:"radical",type:n.FN,sign:!1,handler:e.r(23)},mathrel:{name:"mathrel",type:n.FN,sign:!1,handler:e.r(53)},sum:{name:"summation",type:n.FN,traversal:"rtl",handler:e.r(24)},"int":{name:"integration",type:n.FN,traversal:"rtl",handler:e.r(16)},brackets:{name:"brackets",type:n.FN,handler:e.r(12)},mathcal:{name:"mathcal",type:n.FN,sign:!1,handler:e.r(19)},mathfrak:{name:"mathfrak",type:n.FN,sign:!1,handler:e.r(20)},mathbb:{name:"mathbb",type:n.FN,sign:!1,handler:e.r(18)},mathrm:{name:"mathrm",type:n.FN,sign:!1,handler:e.r(21)},stackrel:{name:"stackrel",type:n.FN,sign:!1,handler:e.r(45)},underline:{name:"underline",type:n.FN,sign:!1,handler:e.r(47)},xrightarrow:{name:"xrightarrow",type:n.FN,sign:!1,handler:e.r(47)},overline:{name:"overline",type:n.FN,sign:!1,handler:e.r(47)},widehat:{name:"widehat",type:n.FN,sign:!1,handler:e.r(47)},overrightarrow:{name:"overrightarrow",type:n.FN,sign:!1,handler:e.r(47)},dot:{name:"dot",type:n.FN,sign:!1,handler:e.r(47)},underbrace:{name:"underbrace",type:n.FN,sign:!1,handler:e.r(47)}}}},e[8]={value:function(){return{"int":e.r(26),quot:e.r(27)}}},e[9]={value:function(){return{combination:e.r(29),fraction:e.r(30),"function":e.r(31),integration:e.r(32),subscript:e.r(39),superscript:e.r(41),script:e.r(37),radical:e.r(38),mathrel:e.r(52),summation:e.r(40),brackets:e.r(28),mathcal:e.r(34),mathfrak:e.r(35),mathbb:e.r(33),mathrm:e.r(36),stackrel:e.r(46),underline:e.r(48),xrightarrow:e.r(55),overline:e.r(49),widehat:e.r(50),overrightarrow:e.r(54),dot:e.r(56),underbrace:e.r(51)}}},e[10]={value:function(){return{"#":1,$:1,"%":1,_:1,"&":1,"{":1,"}":1,"^":1,"~":1}}},e[11]={value:function(){return{OP:1,FN:2}}},e[12]={value:function(){var r=e.r(5);return function(e,n,t){for(var a=0,i=e.params.length;i>a;a++)if(!(e.params[a]in r))throw new Error("Brackets: invalid params");return e.operand=e.params,e.params[2]=t.shift(),delete e.handler,delete e.params,e}}},e[13]={value:function(){return function(){return{name:"combination",operand:arguments[0]||[]}}}},e[14]={value:function(){return function(r,e,n){var t=n.shift(),a=n.shift();if(void 0===t||void 0===a)throw new Error("Frac: Syntax Error");return t.handler&&"integration"===t.name?(t=t.handler(t,e,[a]),a=n.shift()):a.handler&&"integration"===a.name&&(a=a.handler(a,e,[n.shift()])),r.operand=[t,a],delete r.handler,r}}},e[15]={value:function(){var r=e.r(17);return function(e,n,t){var a=r.exec(t);return a.expr&&a.expr.handler&&"integration"===a.expr.name&&(a.expr=a.expr.handler(a.expr,n,[t.shift()])),e.operand=[e.params,a.expr,a.superscript,a.subscript],delete e.params,delete e.handler,e}}},e[16]={value:function(){var r=e.r(17),n=e.r(11).FN;return function(e,t,a){var i=a.shift(),u=r.exec(a);return u.expr&&u.expr.type===n&&u.expr.handler&&"integration"===u.expr.name&&(u.expr=u.expr.handler(u.expr,t,[a.shift()])),e.operand=[u.expr,u.superscript,u.subscript],e.callFn={setType:[0|i]},delete e.handler,e}}},e[17]={value:function(){function r(r){var n=e(r),t=null,a={superscript:null,subscript:null};if(!n)return a;if(t=e(r),a[n.type]=n.value||null,t){if(t.type===n.type)throw new Error("Script: syntax error!");a[t.type]=t.value||null}return a}function e(r){var e=r.shift();return e?"subscript"===e.name||"superscript"===e.name?{type:e.name,value:r.shift()}:(r.unshift(e),null):null}return{exec:function(e){var n=r(e),t=e.shift();if(t&&t.name&&-1!==t.name.indexOf("script"))throw new Error("Script: syntax error!");return n.expr=t||null,n}}}},e[18]={value:function(){return function(r,e,n){var t=n.shift();return"object"==typeof t&&"combination"===t.name&&(t=t.operand.join("")),r.name="text",r.attr={_reverse:"mathbb"},r.callFn={setFamily:["KF AMS BB"]},r.operand=[t],delete r.handler,r}}},e[19]={value:function(){return function(r,e,n){var t=n.shift();return"object"==typeof t&&"combination"===t.name&&(t=t.operand.join("")),r.name="text",r.attr={_reverse:"mathcal"},r.callFn={setFamily:["KF AMS CAL"]},r.operand=[t],delete r.handler,r}}},e[20]={value:function(){return function(r,e,n){var t=n.shift();return"object"==typeof t&&"combination"===t.name&&(t=t.operand.join("")),r.name="text",r.attr={_reverse:"mathfrak"},r.callFn={setFamily:["KF AMS FRAK"]},r.operand=[t],delete r.handler,r}}},e[21]={value:function(){return function(r,e,n){var t=n.shift();return"object"==typeof t&&"combination"===t.name&&(t=t.operand.join("")),r.name="text",r.attr={_reverse:"mathrm"},r.callFn={setFamily:["KF AMS ROMAN"]},r.operand=[t],delete r.handler,r}}},e[22]={value:function(){return function(r,e,n){var t=e.pop(),a=n.shift()||null;if(!a)throw new Error("Missing script");if(t=t||"",t.name===r.name||"script"===t.name)throw new Error("script error");return"subscript"===t.name?(t.name="script",t.operand[2]=t.operand[1],t.operand[1]=a,t):"superscript"===t.name?(t.name="script",t.operand[2]=a,t):(r.operand=[t,a],delete r.handler,r)}}},e[23]={value:function(){var r=e.r(13);return function(e,n,t){var a=t.shift(),i=null,u=null;if("["===a){for(a=[];(i=t.shift())&&"]"!==i;)a.push(i);a=0===a.length?null:r(a),u=t.shift()}else u=a,a=null;return e.operand=[u,a],delete e.handler,e}}},e[24]={value:function(){var r=e.r(17),n=e.r(11).FN;return function(e,t,a){var i=r.exec(a);return i.expr&&i.expr.type===n&&i.expr.handler&&"integration"===i.expr.name&&(i.expr=i.expr.handler(i.expr,t,[a.shift()])),e.operand=[i.expr,i.superscript,i.subscript],delete e.handler,e}}},e[25]={value:function(){function r(r){if(t(r))return r.substring(1);switch(f.getLatexType(r)){case"operator":return f.getDefine(r);case"function":return f.getFuncDefine(r);default:return n(r)}}function n(r){return 0===r.indexOf("\\")?r+"\\":r}function t(r){return 0===r.indexOf("\\")?!!p[r.substring(1)]:!1}function a(r){return r.replace(/\\\s+/,"").replace(/\s*([^a-z0-9\s])\s*/gi,function(r,e){return e})}var i=e.r(43).Parser,u=e.r(1),o=e.r(8),c=e.r(42),s=e.r(7),l=e.r(9),p=e.r(10),f=e.r(4),h="￸",d="￼",v=new RegExp(h+"|"+d,"g"),m=new RegExp(h,"g"),g=new RegExp(d,"g");i.register("latex",i.implement({parse:function(r){var e=this.split(this.format(r));return e=this.parseToGroup(e),e=this.parseToStruct(e),this.generateTree(e)},serialization:function(r,e){return c(r,e)},expand:function(r){var e=r.parse,n=null,t=r.pre,a=r.reverse;for(var i in e)e.hasOwnProperty(i)&&(n=i.replace(/\\/g,""),s[n]=e[i]);for(var i in a)a.hasOwnProperty(i)&&(l[i.replace(/\\/g,"")]=a[i]);if(t)for(var i in t)t.hasOwnProperty(i)&&(o[i.replace(/\\/g,"")]=t[i])},format:function(r){r=a(r),r=r.replace(v,"").replace(/\\{/gi,h).replace(/\\}/gi,d);for(var e in o)o.hasOwnProperty(e)&&(r=o[e](r));return r},split:function(r){var e=[],n=/(?:\\[^a-z]\s*)|(?:\\[a-z]+\s*)|(?:[{}]\s*)|(?:[^\\{}]\s*)/gi,t=/^\s+|\s+$/g,a=null;for(r=r.replace(t,"");a=n.exec(r);)a=a[0].replace(t,""),a&&e.push(a);return e},generateTree:function(r){for(var e=[],n=null;n=r.shift();)e.push(f.isArray(n)?this.generateTree(n):n);return e=u.toRPNExpression(e),u.generateTree(e)},parseToGroup:function(r){for(var e=[],n=[e],t=0,a=0,i=0,u=r.length;u>i;i++)switch(r[i]){case"{":t++,n.push(e),e.push([]),e=e[e.length-1];break;case"}":t--,e=n.pop();break;case"\\left":a++,n.push(e),e.push([[]]),e=e[e.length-1][0],e.type="brackets",i++,e.leftBrackets=r[i].replace(m,"{").replace(g,"}");break;case"\\right":a--,i++,e.rightBrackets=r[i].replace(m,"{").replace(g,"}"),e=n.pop();break;default:e.push(r[i].replace(m,"\\{").replace(g,"\\}"))}if(0!==t)throw new Error("Group Error!");if(0!==a)throw new Error("Brackets Error!");return n[0]},parseToStruct:function(e){for(var n=[],t=0,a=e.length;a>t;t++)f.isArray(e[t])?"brackets"===e[t].type?(n.push(f.getBracketsDefine(e[t].leftBrackets,e[t].rightBrackets)),n.push(this.parseToStruct(e[t]))):n.push(this.parseToStruct(e[t])):n.push(r(e[t]));return n}}))}},e[26]={value:function(){return function(r){return r.replace(/\\(i+)nt(\b|[^a-zA-Z])/g,function(r,e,n){return"\\int "+e.length+n})}}},e[27]={value:function(){return function(r){return r.replace(/``/g,"“")}}},e[28]={value:function(){return function(r){return("{"===r[0]||"}"===r[0])&&(r[0]="\\"+r[0]),("{"===r[1]||"}"===r[1])&&(r[1]="\\"+r[1]),["\\left",r[0],r[2],"\\right",r[1]].join(" ")}}},e[29]={value:function(){return function(r){return this.attr&&(this.attr["data-root"]||this.attr["data-placeholder"])?r.join(""):"{"+r.join("")+"}"}}},e[30]={value:function(){return function(r){return"\\frac "+r[0]+" "+r[1]}}},e[31]={value:function(){return function(r){var e=["\\"+r[0]];return r[2]&&e.push("^"+r[2]),r[3]&&e.push("_"+r[3]),r[1]&&e.push(" "+r[1]),e.join("")}}},e[32]={value:function(){return function(r){var e=["\\int "];if(this.callFn&&this.callFn.setType){e=["\\"];for(var n=0,t=this.callFn.setType;t>n;n++)e.push("i");e.push("nt ")}return r[1]&&e.push("^"+r[1]),r[2]&&e.push("_"+r[2]),r[0]&&e.push(" "+r[0]),e.join("")}}},e[33]={value:function(){return function(r){return"\\mathbb{"+r[0]+"}"}}},e[34]={value:function(){return function(r){return"\\mathcal{"+r[0]+"}"}}},e[35]={value:function(){return function(r){return"\\mathfrak{"+r[0]+"}"}}},e[36]={value:function(){return function(r){return"\\mathrm{"+r[0]+"}"}}},e[37]={value:function(){return function(r){return r[0]+"^"+r[1]+"_"+r[2]}}},e[38]={value:function(){return function(r){var e=["\\sqrt"];return r[1]&&e.push("["+r[1]+"]"),e.push(" "+r[0]),e.join("")}}},e[39]={value:function(){return function(r){return r[0]+"_"+r[1]}}},e[40]={value:function(){return function(r){var e=["\\sum "];return r[1]&&e.push("^"+r[1]),r[2]&&e.push("_"+r[2]),r[0]&&e.push(" "+r[0]),e.join("")}}},e[41]={value:function(){return function(r){return r[0]+"^"+r[1]}}},e[42]={value:function(){function r(e,a){var u=[],o=null,c=null;if("object"!=typeof e)return n(e)?"\\"+e+" ":e.replace(i,function(r,e){return e+" "});"combination"===e.name&&1===e.operand.length&&"combination"===e.operand[0].name&&(e=e.operand[0]),c=e.operand;for(var s=0,l=c.length;l>s;s++)u.push(c[s]?r(c[s]):c[s]);return o=e.attr&&e.attr._reverse?e.attr._reverse:e.name,t[o].call(e,u,a)}function n(r){return!!a[r]}var t=e.r(9),a=e.r(10),i=/(\\(?:[\w]+)|(?:[^a-z]))\\/gi;return function(e,n){return r(e,n)}}},e[43]={value:function(r,e,n){function t(r){this.impl=new r,this.conf={}}function a(){this.conf={}}var i={},u={},o={extend:function(r,e){var n=null;e=[].slice.call(arguments,1);for(var t=0,a=e.length;a>t;t++){n=e[t];for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])}},setData:function(r,e,n){if("string"==typeof e)r[e]=n;else{if("object"!=typeof e)throw new Error("invalid option");for(n in e)e.hasOwnProperty(n)&&(r[n]=e[n])}}},c={use:function(r){if(!u[r])throw new Error("unknown parser type");return this.proxy(u[r])},config:function(r,e){return o.setData(i,r,e),this},register:function(r,e){return u[r.toLowerCase()]=e,this},implement:function(r){var e=function(){},n=r.constructor||function(){},t=function(){a.call(this),n.call(this)};e.prototype=a.prototype,t.prototype=new e,delete r.constructor;for(var i in r)"constructor"!==i&&r.hasOwnProperty(i)&&(t.prototype[i]=r[i]);return t},proxy:function(r){return new t(r)}};o.extend(t.prototype,{config:function(r,e){o.setData(this.conf,r,e)},set:function(r,e){this.impl.set(r,e)},parse:function(r){var e={config:{},tree:this.impl.parse(r)};return o.extend(e.config,i,this.conf),e},serialization:function(r,e){return this.impl.serialization(r,e)},expand:function(r){this.impl.expand(r)}}),o.extend(a.prototype,{set:function(r,e){o.extend(this.conf,r,e)},parse:function(){throw new Error("Abstract function")}}),n.exports={Parser:c,ParserInterface:a}}},e[44]={value:function(){var r=e.r(43).Parser;e.r(25),window.kf.Parser=r,window.kf.Assembly=e.r(0)}},e[45]={value:function(){return function(r,e,n){var t=n.shift(),a=n.shift();if(void 0===t||void 0===a)throw new Error("Stackrel: Syntax Error");return t.handler&&"integration"===t.name?(t=t.handler(t,e,[a]),a=n.shift()):a.handler&&"integration"===a.name&&(a=a.handler(a,e,[n.shift()])),r.operand=[t,a],delete r.handler,r}}},e[46]={value:function(){return function(r){return"\\stackrel "+r[0]+" "+r[1]}}},e[47]={value:function(){e.r(13);return function(r,e,n){var t=n.shift(),a=t;return r.operand=[a],delete r.handler,r}}},e[48]={value:function(){return function(r){return"\\underline{"+r[0]+"}"}}},e[49]={value:function(){return function(r){return"\\overline{"+r[0]+"}"}}},e[50]={value:function(){return function(r){return"\\widehat{"+r[0]+"}"}}},e[51]={value:function(){return function(r){return"\\underbrace{"+r[0]+"}"}}},e[52]={value:function(){return function(r){return"\\mathrel{"+r[0]+"}"}}},e[53]={value:function(){e.r(13);return function(r,e,n){var t=n.shift(),a=t;return r.operand=[a],delete r.handler,r}}},e[54]={value:function(){return function(r){return"\\overrightarrow{"+r[0]+"}"}}},e[55]={value:function(){return function(r){return"\\xrightarrow{"+r[0]+"}"}}},e[56]={value:function(){return function(r){return"\\dot{"+r[0]+"}"}}},e[100]={};var n={"kf.start":44};!function(){try{r("kf.start")}catch(e){}}(this)}();